DDV Product Agent Search Flow Diagram
=====================================

User Input: "tìm điện thoại giá rẻ"
    ↓
┌─────────────────────────────────────┐
│     Simplified Product Agent        │
│  (simplified_agent.py)             │
│  - Model: gemini-2.0-flash         │
│  - Tool: enhanced_product_search_tool│
└─────────────────┬───────────────────┘
                  ↓
┌─────────────────────────────────────┐
│   Enhanced Product Search Tool      │
│  (simplified_tools.py)             │
│  - Extract: budget, brands, features│
│  - Build filters                    │
│  - Call enhanced_data_store         │
└─────────────────┬───────────────────┘
                  ↓
┌─────────────────────────────────────┐
│     Enhanced Product Store          │
│  (enhanced_product_store.py)       │
│  - search_products()                │
│  - Call MeilisearchEngine           │
└─────────────────┬───────────────────┘
                  ↓
┌─────────────────────────────────────┐
│      Meilisearch Engine             │
│  (meilisearch_engine.py)           │
│  - Prepare search parameters        │
│  - Execute search on index          │
│  - Process results                  │
└─────────────────┬───────────────────┘
                  ↓
┌─────────────────────────────────────┐
│      Meilisearch Index              │
│  - Search in: name, brand, category │
│  - Search in: specs.*, promotions.* │
│  - Search in: _searchable_text      │
│  - Return ranked results            │
└─────────────────┬───────────────────┘
                  ↓
┌─────────────────────────────────────┐
│      Results Processing             │
│  - Add search_metadata              │
│  - Build UI payload                 │
│  - Create product_display           │
│  - Add AI analysis                  │
└─────────────────┬───────────────────┘
                  ↓
┌─────────────────────────────────────┐
│        Final Response               │
│  {                                  │
│    "success": true,                 │
│    "products": [...],               │
│    "product_display": {             │
│      "type": "product-display",     │
│      "products": [...],             │
│      "ai_analysis": [...]           │
│    }                                │
│  }                                  │
└─────────────────────────────────────┘

Key Components:
===============

1. Simplified Product Agent
   - Entry point for user queries
   - Uses Gemini 2.0 Flash model
   - Orchestrates the search process

2. Enhanced Product Search Tool
   - Extracts requirements from natural language
   - Builds search filters
   - Formats results for UI

3. Enhanced Product Store
   - Abstraction layer
   - Manages search engine integration
   - Handles data loading

4. Meilisearch Engine
   - Fast full-text search
   - Handles complex queries
   - Provides relevance scoring

5. Meilisearch Index
   - Contains all product data
   - Searchable fields: name, specs, promotions
   - Optimized for Vietnamese text

Search Capabilities:
===================

✅ Natural Language Queries
   - "tìm điện thoại giá rẻ"
   - "iPhone camera tốt"
   - "Samsung màn hình OLED"

✅ Spec-based Search
   - "48MP camera"
   - "256GB storage"
   - "5G network"

✅ Brand & Category Filtering
   - "Apple iPhone"
   - "Samsung Galaxy"
   - "điện thoại Android"

✅ Price Range Search
   - "dưới 10 triệu"
   - "15-20 triệu"
   - "giá rẻ"

✅ Promotion Search
   - "có khuyến mãi"
   - "giảm giá"
   - "tặng kèm phụ kiện"

Performance:
===========

- Search Time: <50ms
- Index Size: All product data
- Relevance: AI-powered scoring
- Language: Vietnamese + English
- Typo Tolerance: Built-in


